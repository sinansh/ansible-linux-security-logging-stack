# Install and configure auditd
# This role installs `auditd`, deploys rules, and ensures the service is running.
- name: Install auditd package
  package:
    name: auditd
    state: present
  become: true

- name: Deploy audit rules for SIEM
  template:
    src: audit.rules.j2
    dest: "{{ audit_rules_path }}"
    owner: root
    group: root
    mode: '0640'
  notify: Reload auditd rules
  become: true

- name: Ensure auditd is enabled and running
  systemd:
    name: auditd
    enabled: true
    state: started
  become: true
